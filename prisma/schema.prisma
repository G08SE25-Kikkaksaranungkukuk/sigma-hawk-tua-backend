generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  user_id       Int           @id @default(autoincrement())
  first_name    String
  middle_name   String?
  last_name     String
  birth_date    DateTime
  sex           String
  phone         String
  profile_url   String?
  social_credit Int           @default(0)
  interests     Interest[]
  travel_styles TravelStyle[]
  password      String
  email         String        @unique
  headOf        Group[]       @relation("IsHeadOf")
  Interaction   Interaction[]
  requests      RequestJoin[]
  groups        Group[]       @relation("Belongs")
}

model Group {
  group_id        Int              @id @default(autoincrement())
  group_name      String
  group_leader_id Int
  interest_fields String[]
  leader          User             @relation("IsHeadOf", fields: [group_leader_id], references: [user_id])
  itineraries     GroupItinerary[]
  requests        RequestJoin[]
  members         User[]           @relation("Belongs")
}

model RequestJoin {
  id       Int   @id @default(autoincrement())
  user_id  Int
  group_id Int
  group    Group @relation(fields: [group_id], references: [group_id])
  user     User  @relation(fields: [user_id], references: [user_id])
}

model Interaction {
  id      Int      @id @default(autoincrement())
  message String?
  like    Boolean?
  dislike Boolean?
  picture String?
  user_id Int
  user    User     @relation(fields: [user_id], references: [user_id])
}

model Place {
  place_id     Int         @id @default(autoincrement())
  name         String
  description  String?
  place_type   String?
  latitude     Float?
  longitude    Float?
  picture_url  String?
  phone_num    String?
  social_media String?
  Itinerary    Itinerary[] @relation("CreateEditItinerary")
}

model Itinerary {
  itinerary_id Int              @id @default(autoincrement())
  start_date   DateTime
  end_date     DateTime
  groups       GroupItinerary[]
  places       Place[]          @relation("CreateEditItinerary")
}

model GroupItinerary {
  id           Int       @id @default(autoincrement())
  group_id     Int
  itinerary_id Int
  group        Group     @relation(fields: [group_id], references: [group_id])
  itinerary    Itinerary @relation(fields: [itinerary_id], references: [itinerary_id])
}

enum Interest {
  SEA
  MOUNTAIN
  WATERFALL
  NATIONAL_PARK
  ISLAND
  TEMPLE
  SHOPPING_MALL
  MARKET
  CAFE
  HISTORICAL
  AMUSEMENT_PARK
  ZOO
  FESTIVAL
  MUSEUM
  FOOD_STREET
  BEACH_BAR
  THEATRE
}

enum TravelStyle {
  BUDGET
}
